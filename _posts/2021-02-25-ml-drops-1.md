---
layout: post
title: ML Drops v1
subtitle: Feliz Aniversário, AWS Cloudformation.
tags: [aws, mlops, cloudformation, iaac, iac]
comments: true
draft: true
---

Dia 25 de fevereiro, hoje o serviço [AWS Cloudformation completa 10 anos](https://aws.amazon.com/pt/about-aws/whats-new/2011/02/25/introducing-aws-cloudformation/)!

Através dos *templates* do Cloudformation somos capazes de provisionar nossa infraestrutura como código, garantindo mantenabilidade, versionamento e reaproveitamento.

```yaml
AWSTemplateFormatVersion: 2010-09-09
Parameters:
  BucketName:
    Type: String
    Description: 'The name of the S3 Bucket to create, make this unique'
Resources:
  S3BUCKET:
    Type: 'AWS::S3::Bucket'
    Properties:
      BucketName: !Ref BucketName
```
<p style="text-align: center">Exemplo de template de cloudformation para criação de um bucket S3</p>

Para comemorar essa marca, **listamos 10 dicas e curiosidades sobre este serviço**.

## DependsOn

Ao adicionar a chave `DependsOn` em um recurso, garantimos que aquele recurso só será executado após um outro recursos ser instanciado.

```yaml
AWSTemplateFormatVersion: 2010-09-09
Resources:
  BucketOne:
    Type: 'AWS::S3::Bucket'
    Properties:
      BucketName: !Ref BucketName1
  BucketTwo:
    DependsOn: BucketOne  # O BucketTwo inicia somente após o BucketOne 
    Type: 'AWS::S3::Bucket'
    Properties:
      BucketName: !Ref BucketName2
```

## Cfn-Lint

O pacote python [`crn-lint`](https://pypi.org/project/cfn-lint/) fornece um validador para *templates* de cloudformation, informando possíveis erros e falhas de construção.

```sh
$ cfn-lint template.yml

E3002 Invalid Property Resources/Function/Properties/Packagetype
infra/lambda.yml:12:7
```

## Stack Sets

Precisa executar em seu cloudformation em diferentes contas da AWS? Você precisa conhecer as [`stack sets`](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacksets-concepts.html).

```sh
aws cloudformation create-stack-set \ 
      --stack-set-name StackSet_myApp \
      --template-url file://template.yaml \
      --permission-model SERVICE_MANAGED 
      --auto-deployment Enabled=true

aws cloudformation create-stack-instances \
      --stack-set-name StackSet_myApp 
      --accounts 123456789012 223456789012 \
      --regions '["eu-west-1"]'
```

## Cloudformation Registry

Quer inspiração na hora de provisionar seus recursos com Cloudformation? 




## Drift Detection


## SAM


## Custom Modules


## Helper Scripts


## Pseudo-Parâmetros




## Não esqueça de executar seus `change sets`